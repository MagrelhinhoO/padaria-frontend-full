{"ast":null,"code":"import { signal } from '@angular/core';\nimport { ProductService } from '../../../../core/services/product/product.service';\nimport Swal from 'sweetalert2';\nimport { CurrencyPipe } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../core/services/product/product.service\";\nimport * as i2 from \"@angular/forms\";\nconst _forTrack0 = ($index, $item) => $item.id;\nfunction ProductListComponent_Conditional_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Carregando...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductListComponent_Conditional_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtext(1, \"Nenhum produto encontrado.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductListComponent_Conditional_21_For_15_Conditional_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 15);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(p_r2.promotionTitle);\n  }\n}\nfunction ProductListComponent_Conditional_21_For_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\")(7, \"span\", 14);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtemplate(10, ProductListComponent_Conditional_21_For_15_Conditional_10_Template, 2, 1, \"span\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 16)(12, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function ProductListComponent_Conditional_21_For_15_Template_button_click_12_listener() {\n      const p_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.editar(p_r2));\n    });\n    i0.ɵɵtext(13, \"Editar\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function ProductListComponent_Conditional_21_For_15_Template_button_click_14_listener() {\n      const p_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.remover(p_r2));\n    });\n    i0.ɵɵtext(15, \"Excluir\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const p_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r2.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 8, p_r2.price, \"BRL\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"text-bg-success\", p_r2.active)(\"text-bg-secondary\", !p_r2.active);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", p_r2.active ? \"Sim\" : \"N\\u00E3o\", \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵconditional(p_r2.promotionTitle ? 10 : -1);\n  }\n}\nfunction ProductListComponent_Conditional_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"table\", 13)(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"Nome\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Pre\\u00E7o\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Ativo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Promo\\u00E7\\u00E3o\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"th\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"tbody\");\n    i0.ɵɵrepeaterCreate(14, ProductListComponent_Conditional_21_For_15_Template, 16, 11, \"tr\", null, _forTrack0);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(14);\n    i0.ɵɵrepeater(ctx_r2.products());\n  }\n}\nexport let ProductListComponent = /*#__PURE__*/(() => {\n  class ProductListComponent {\n    service;\n    products = signal([]);\n    loading = signal(false);\n    filtroNome = '';\n    filtroAtivo = '';\n    constructor(service) {\n      this.service = service;\n    }\n    ngOnInit() {\n      this.load();\n    }\n    load() {\n      this.loading.set(true);\n      const filters = {\n        name: this.filtroNome\n      };\n      if (this.filtroAtivo !== '') filters.active = this.filtroAtivo;\n      // fallback: se service.list não aceitar filtros, usar sem argumento\n      const obs = this.service.list.length > 0 ? this.service.list(filters) : this.service.list();\n      obs.subscribe({\n        next: data => {\n          this.products.set(data);\n          this.loading.set(false);\n        },\n        error: err => {\n          this.loading.set(false);\n          Swal.fire('Erro', err.error?.message || 'Erro ao carregar', 'error');\n        }\n      });\n    }\n    novo() {}\n    editar(p) {}\n    remover(p) {\n      if (!p.id) return;\n      Swal.fire({\n        title: 'Confirmar',\n        text: `Excluir ${p.name}?`,\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'Sim'\n      }).then(r => {\n        if (r?.isConfirmed) {\n          this.service.delete(p.id).subscribe({\n            next: () => {\n              Swal.fire('Sucesso', 'Produto excluído', 'success');\n              this.load();\n            },\n            error: err => Swal.fire('Erro', err.error?.message || 'Falha ao excluir', 'error')\n          });\n        }\n      });\n    }\n    static ɵfac = function ProductListComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ProductListComponent)(i0.ɵɵdirectiveInject(i1.ProductService));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProductListComponent,\n      selectors: [[\"app-product-list\"]],\n      decls: 22,\n      vars: 5,\n      consts: [[1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"mb-3\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"row\", \"g-2\", \"mb-3\"], [1, \"col-md-4\"], [\"placeholder\", \"Nome...\", 1, \"form-control\", 3, \"ngModelChange\", \"keyup.enter\", \"ngModel\"], [1, \"col-md-2\"], [1, \"form-select\", 3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"\"], [\"value\", \"true\"], [\"value\", \"false\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"alert\", \"alert-info\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\", \"table-hover\", \"align-middle\"], [1, \"badge\"], [1, \"badge\", \"text-bg-warning\"], [1, \"text-end\"], [1, \"btn\", \"btn-sm\", \"btn-outline-primary\", \"me-2\", 3, \"click\"], [1, \"btn\", \"btn-sm\", \"btn-outline-danger\", 3, \"click\"]],\n      template: function ProductListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h3\");\n          i0.ɵɵtext(2, \"Produtos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"button\", 1);\n          i0.ɵɵlistener(\"click\", function ProductListComponent_Template_button_click_3_listener() {\n            return ctx.novo();\n          });\n          i0.ɵɵtext(4, \"Novo\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(5, \"div\", 2)(6, \"div\", 3)(7, \"input\", 4);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function ProductListComponent_Template_input_ngModelChange_7_listener($event) {\n            i0.ɵɵtwoWayBindingSet(ctx.filtroNome, $event) || (ctx.filtroNome = $event);\n            return $event;\n          });\n          i0.ɵɵlistener(\"keyup.enter\", function ProductListComponent_Template_input_keyup_enter_7_listener() {\n            return ctx.load();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 5)(9, \"select\", 6);\n          i0.ɵɵtwoWayListener(\"ngModelChange\", function ProductListComponent_Template_select_ngModelChange_9_listener($event) {\n            i0.ɵɵtwoWayBindingSet(ctx.filtroAtivo, $event) || (ctx.filtroAtivo = $event);\n            return $event;\n          });\n          i0.ɵɵlistener(\"change\", function ProductListComponent_Template_select_change_9_listener() {\n            return ctx.load();\n          });\n          i0.ɵɵelementStart(10, \"option\", 7);\n          i0.ɵɵtext(11, \"Ativos/Inativos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"option\", 8);\n          i0.ɵɵtext(13, \"Ativos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(14, \"option\", 9);\n          i0.ɵɵtext(15, \"Inativos\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(16, \"div\", 5)(17, \"button\", 10);\n          i0.ɵɵlistener(\"click\", function ProductListComponent_Template_button_click_17_listener() {\n            return ctx.load();\n          });\n          i0.ɵɵtext(18, \"Filtrar\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(19, ProductListComponent_Conditional_19_Template, 2, 0, \"div\")(20, ProductListComponent_Conditional_20_Template, 2, 0, \"div\", 11)(21, ProductListComponent_Conditional_21_Template, 16, 0, \"div\", 12);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(7);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filtroNome);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtwoWayProperty(\"ngModel\", ctx.filtroAtivo);\n          i0.ɵɵadvance(10);\n          i0.ɵɵconditional(ctx.loading() ? 19 : -1);\n          i0.ɵɵadvance();\n          i0.ɵɵconditional(!ctx.loading() && ctx.products().length === 0 ? 20 : -1);\n          i0.ɵɵadvance();\n          i0.ɵɵconditional(!ctx.loading() && ctx.products().length > 0 ? 21 : -1);\n        }\n      },\n      dependencies: [CurrencyPipe, FormsModule, i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.DefaultValueAccessor, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgModel],\n      encapsulation: 2\n    });\n  }\n  return ProductListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}