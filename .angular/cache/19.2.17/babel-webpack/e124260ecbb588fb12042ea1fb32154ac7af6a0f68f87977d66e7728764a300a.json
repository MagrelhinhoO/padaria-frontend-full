{"ast":null,"code":"import { inject } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { tap } from 'rxjs';\nimport { environment } from '../../../../environments/environment';\nimport { TokenService } from './token.service';\nimport * as i0 from \"@angular/core\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    http = inject(HttpClient);\n    tokenService = inject(TokenService);\n    baseUrl = `${environment.apiUrl}/auth`;\n    login(req) {\n      // Backend original aceitava 'username'. Se agora usamos 'email', enviamos ambos para compatibilidade.\n      const payload = {\n        ...req\n      };\n      if (req.email && !('username' in payload)) {\n        payload.username = req.email;\n      }\n      return this.http.post(`${this.baseUrl}/login`, payload).pipe(tap(res => this.tokenService.setSession(res.token, res.roles, res.name)));\n    }\n    logout() {\n      this.tokenService.clear();\n    }\n    isAuthenticated() {\n      return !!this.tokenService.token;\n    }\n    static ɵfac = function AuthService_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || AuthService)();\n    };\n    static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthService,\n      factory: AuthService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}